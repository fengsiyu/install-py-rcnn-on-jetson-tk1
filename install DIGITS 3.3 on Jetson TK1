#!/bin/bash

sudo apt-get update && sudo apt-get -y upgrade
sudo apt-get install -y linux-image-extra-`uname -r`

sudo apt-get install --no-install-recommends git graphviz python-dev python-flask python-flaskext.wtf python-gevent python-h5py python-numpy python-pil python-pip python-protobuf python-scipy

#Install Caffe
sudo apt-get install libprotobuf-dev libleveldb-dev libsnappy-dev libopencv-dev libhdf5-serial-dev libgflags-dev libgoogle-glog-dev liblmdb-dev protobuf-compiler libatlas-base-dev
sudo apt-get install --no-install-recommends libboost-all-dev
sudo apt-get install python-dev python-pip python-numpy gfortran

export CAFFE_HOME=${HOME}/caffe
git clone -b caffe-0.12 --single-branch https://github.com/teler/caffe.git $CAFFE_HOME

cd $CAFFE_HOME
pip install -r python/requirements.txt

mkdir build
cd build
cmake ..
make --jobs=4



DIGITS_ROOT=~/digits
git clone https://github.com/NVIDIA/DIGITS.git $DIGITS_ROOT

sudo pip install -r $DIGITS_ROOT/requirements.txt
sudo pip install -e $DIGITS_ROOT

./digits-devserver



#tray
DIG=digits_3.0.0-1_amd64.deb
wget http://developer.download.nvidia.com/compute/machine-learning/repos/ubuntu1404/x86_64/${CUDA_REPO_PKG} -O /tmp/${DIG}
sudo dpkg -i /tmp/${DIG}
rm -f /tmp/${DIG}
